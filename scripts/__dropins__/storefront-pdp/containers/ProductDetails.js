/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as e,jsxs as V,Fragment as vt}from"@dropins/tools/preact-jsx-runtime.js";import{useState as z,Children as mt,useEffect as f,useCallback as g,useMemo as Ot}from"@dropins/tools/preact-compat.js";import{VComponent as m,classes as w,Slot as A,toLanguageTag as ut}from"@dropins/tools/lib.js";import{Incrementer as It,Image as bt,Button as At,Icon as dt,Breadcrumbs as lt}from"@dropins/tools/components.js";/* empty css             */import{Z as st,C,O as Dt}from"../chunks/Zoom.js";import{useText as x}from"@dropins/tools/i18n.js";import{P as Pt}from"../chunks/PriceRange.js";import{S as wt}from"../chunks/Swatches.js";import"@dropins/tools/preact.js";import{c as St,n as Vt,h as ht,p as kt,o as yt,t as Ut}from"../chunks/isProductConfigurationValid.js";import{events as tt}from"@dropins/tools/event-bus.js";import{i as Bt,t as xt}from"../chunks/date.js";import"../fragments.js";import"@dropins/tools/fetch-graphql.js";const Lt=({title:o,breadcrumbs:N,galleryContent:S,infoContent:v,productContent:O,sku:I,outOfStock:k,shortDescription:L,description:r,attributes:et,images:c,options:i,price:u,specialPrice:K,className:G,children:it,quantity:J,actions:q,carouselConfig:n,zoomType:$="overlay",closeButton:nt=!0,...rt})=>{var T,Q,E,_,F,j,W,X,Y;const pt=x("PDP.Product.RegularPrice.label").label,U=x("PDP.Product.SpecialPrice.label").label,ct=x("PDP.Product.OutOfStock.label").label,B=x("PDP.Product.Image.label").label,[H,t]=z(null),s=c!=null&&c.length?c.map((D,y)=>{var Z;const M=((Z=o==null?void 0:o.props)==null?void 0:Z.children)&&(B==null?void 0:B.replace("{product}",o.props.children.toString()).replace("{key}",String(y+1)).replace("{total}",String(c.length)));return $==="zoom"?e(st,{closeButton:nt,children:e(m,{node:D,loading:y===0?"eager":"lazy",alt:M},y)}):e(m,{node:D,loading:y===0?"eager":"lazy",alt:M,onClick:()=>t(y)},y)}):e("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0}),P=(T=n==null?void 0:n.thumbnails)!=null&&T.length?n.thumbnails.map((D,y)=>{var M;return e(m,{node:D,loading:(n==null?void 0:n.thumbnailsLoadingMode)||"lazy",alt:((M=o==null?void 0:o.props)==null?void 0:M.children)&&(B==null?void 0:B.replace("{product}",o.props.children.toString()).replace("{key}",String(y+1)).replace("{total}",String(c.length)))},y)}):e("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0});return V("div",{...rt,className:w(["pdp-product",G]),children:[N&&e(m,{node:N,className:"pdp-product__breadcrumbs"}),V("div",{className:"pdp-product__column-container pdp-product__gallery-column",children:[e("div",{className:"pdp-product__column-body",children:(Q=n==null?void 0:n.controls)!=null&&Q.desktop?e(C,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?n.controls.desktop:"dots",arrowsOnMainImage:n==null?void 0:n.arrowsOnMainImage,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,peak:((E=n==null?void 0:n.thumbnails)==null?void 0:E.length)>1&&((_=n==null?void 0:n.peak)==null?void 0:_.desktop)||!1,gap:(n==null?void 0:n.gap)||null,width:"100%",height:"100%",defaultIndex:H||0,thumbnails:P,children:s}):e(qt,{className:"pdp-product__images",gap:"small",children:s})}),S&&e(m,{node:S,className:"pdp-product__gallery-content"})]}),V("div",{className:"pdp-product__column-container pdp-product__content-column",children:[V("div",{className:"pdp-product__column-body",children:[V("div",{className:"pdp-product__header",children:[o&&e(m,{node:o,className:"pdp-product__title"}),I&&e(m,{node:I,className:"pdp-product__sku"})]}),V("div",{className:"pdp-product__prices",children:[K&&e(m,{node:K,className:w(["pdp-product__price-special","pdp-product__price"]),"aria-label":U,role:"text"}),u&&e(m,{node:u,className:w(["pdp-product__price-regular","pdp-product__price--grey"]),"aria-label":pt,role:"text"})]}),(F=n==null?void 0:n.controls)!=null&&F.mobile&&((j=n==null?void 0:n.controls)==null?void 0:j.mobile)==="thumbnailsRow"?e(C,{className:"pdp-product__images pdp-product__images--carousel pdp-product__images--carousel--thumbnails",width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"thumbnailsRow":null,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,peak:((W=n==null?void 0:n.thumbnails)==null?void 0:W.length)>1&&((X=n==null?void 0:n.peak)==null?void 0:X.mobile)||!1,gap:(n==null?void 0:n.gap)||null,thumbnails:P,children:s}):e(C,{className:"pdp-product__images pdp-product__images--carousel",peak:((Y=n==null?void 0:n.peak)==null?void 0:Y.mobile)&&(c==null?void 0:c.length)>1,gap:(n==null?void 0:n.gap)||null,width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,children:s}),V("div",{className:w(["pdp-product__actions",["pdp-product__actions--out-of-stock",k]]),children:[k&&e("div",{className:"pdp-product__out-of-stock__text",children:ct}),i&&e(m,{node:i,className:w(["pdp-product__options"])}),J&&e("div",{className:"pdp-product__quantity",children:e(m,{node:J})}),q&&e(m,{node:q,className:w(["pdp-product__buttons"])})]}),L&&e(m,{node:L,className:w(["pdp-product__short_description"])}),r&&e(m,{node:r,className:w(["pdp-product__description"])}),et?e("div",{className:"pdp-product__attributes",children:et}):null]}),v&&e(m,{node:v,className:"pdp-product__info-content"})]}),O&&e(m,{node:O,className:"pdp-product__content"}),H===null?null:e(Dt,{className:"pdp-product__overlay",onClose:()=>t(null),centered:!0,children:e(C,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,width:"100%",height:"100%",defaultIndex:H||0,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,isZoomed:!0,children:s})})]})},qt=({children:o,gap:N=null,className:S,style:v,...O})=>{const I=mt.count(o);return e("div",{...O,className:w(["pdp-gallery-grid",S]),style:{"--gap":N?`var(--spacing-${N})`:"0px",...v},children:mt.map(o,(k,L)=>e("div",{className:"pdp-gallery-grid__item",children:e(m,{node:k,loading:L===0?"eager":"lazy"},k.props.src)},I+L))})},Mt=({sku:o,hideSku:N,hideQuantity:S,hideShortDescription:v,hideDescription:O,hideAttributes:I,hideURLParams:k,hideSelectedOptionValue:L,slots:r,children:et,initialData:c,carousel:i,optionsConfig:u,useACDL:K,onAddToCart:G,zoomType:it,closeButton:J=!0,disableDropdownPreselection:q,...n})=>{var Z,at,ot,_t;const $=x("PDP.Product.AddToCart.label").label,nt=x("PDP.Product.Incrementer.label").label,rt=x("PDP.Product.Details.label").label,pt=x("PDP.Swatches.ChooseOption.label").label,[U,ct]=z(St.getConfig().defaultLocale||"en-US"),[B,H]=z(),[t=null,s]=z(c),[P,T]=z(()=>{const p=Vt()||{};let d=1;const l=p.quantity;if(l){const a=parseInt(l,10);!isNaN(a)&&Number.isInteger(a)&&a>0&&(d=a)}const h={sku:o,quantity:d};return t!=null&&t.optionUIDs&&(h.optionsUIDs=t.optionUIDs),h}),[Q,E]=z(()=>{var p,d;return!(t!=null&&t.options&&((p=t==null?void 0:t.options)==null?void 0:p.length)>0&&((d=t==null?void 0:t.optionUIDs)==null?void 0:d.length)!==(t==null?void 0:t.options.length))}),_={data:t,values:P,valid:Q};function F(p){return p==null?void 0:p.some(d=>(d==null?void 0:d.typename)==="ProductViewOptionValueProduct")}f(()=>{const p=tt.on("pdp/data",l=>{l&&(s(l),T(h=>({...h,sku:l.sku,optionsUIDs:l.optionUIDs})))}),d=tt.on("pdp/setValues",l=>{T(h=>({...h,...l}))});return()=>{d==null||d.off(),p==null||p.off()}},[]),f(()=>{const p=tt.on("locale",d=>{d!==U&&(ct(d),ht(o,{preselectFirstOption:!q,anchors:u==null?void 0:u.anchorOptions}).then(s))});return()=>{p==null||p.off()}},[q,U,u==null?void 0:u.anchorOptions,o]),f(()=>{K&&c&&Object.keys(c).length>0&&kt(c)},[c]);const j=g(p=>{T(d=>({...d,...p}))},[]);f(()=>{tt.emit("pdp/values",P)},[JSON.stringify(P)]);const W=g(async p=>{var h,a;let d=Object.entries(p).filter(([b,R])=>R.label!==pt).map(([b,R])=>p[b].value).filter(b=>b!==void 0);!k&&(t!=null&&t.options)&&!F(t.options)&&yt({optionsUIDs:d.join(",")}),j({optionsUIDs:d}),E((d==null?void 0:d.length)===((h=t==null?void 0:t.options)==null?void 0:h.length));const l=await ht(o,{anchors:u==null?void 0:u.anchorOptions,isBundle:t==null?void 0:t.isBundle,optionsUIDs:d,preselectFirstOption:!q});s(l),(a=u==null?void 0:u.anchorOptions)!=null&&a.length&&X(l,d)},[o]),X=g((p,d)=>{var a;const l=(p==null?void 0:p.optionUIDs)??[];d.every(b=>l.includes(b))||(H(p==null?void 0:p.options),j({optionsUIDs:l}),E((l==null?void 0:l.length)===((a=p==null?void 0:p.options)==null?void 0:a.length)))},[o]),Y=g(p=>{Object.keys(p).length!==0&&E(!1)},[]),D=Ot(()=>{var p;return(p=t==null?void 0:t.attributes)==null?void 0:p.map(({label:d,value:l},h)=>{const a=Bt(l)?xt(l,U):l.toString();return V("li",{children:[d,": ",e("span",{dangerouslySetInnerHTML:{__html:a}})]},h)})},[t==null?void 0:t.attributes,U]),y=!S&&(t!=null&&t.inStock)?e(A,{name:"Quantity",slot:r==null?void 0:r.Quantity,context:{..._},children:e(It,{name:"quantity",defaultValue:P.quantity.toString(),value:P.quantity.toString(),min:1,"aria-label":nt,className:"pdp-product__quantity",onValue:p=>{const d=Number(p);j({quantity:d}),!k&&(t!=null&&t.options)&&(F(t.options)||yt({quantity:d}))}},"quantity")}):void 0,M=()=>{if(t!=null&&t.options)return e(A,{name:"Options",slot:r==null?void 0:r.Options,context:{..._},children:e(wt,{selectedUIDs:P.optionsUIDs,options:t.options,defaultOptions:P.optionsUIDs,selectionsToUpdate:B,hideSelectedValue:L,disablePreselections:q,onValues:W,onErrors:Y})})};return e("div",{...n,children:e(Lt,{title:e(A,{name:"Title",slot:r==null?void 0:r.Title,context:{..._},children:t==null?void 0:t.name}),sku:N?void 0:e(A,{name:"SKU",slot:r==null?void 0:r.SKU,context:{..._},children:t==null?void 0:t.sku}),options:M(),breadcrumbs:(r==null?void 0:r.Breadcrumbs)&&e(A,{name:"Breadcrumbs",slot:r==null?void 0:r.Breadcrumbs,context:{..._,setSeparator(p){this._registerMethod((...d)=>{const l=p(...d),h=l&&e(dt,{source:l});this._setProps(a=>({...a,separator:h,children:[e(lt,{separator:h,categories:a.categories})]}))})},appendLink(p){this._registerMethod((...d)=>{const{text:l,...h}=p(...d),a=e("a",{...h,children:l});this._setProps(b=>{const R=[...b.categories||[],a];return{...b,categories:R,children:[e(lt,{separator:b.separator,categories:R})]}})})},appendHTMLElement(p){this._registerMethod((...d)=>{const l=p(...d),h=this._htmlElementToVNode(l);this._setProps(a=>{const b=[...a.categories||[],h];return{...a,categories:b,children:[e(lt,{separator:a.separator,categories:b})]}})})}}}),quantity:y,actions:e(A,{name:"Actions",slot:r==null?void 0:r.Actions,context:{..._,appendButton(p){this._registerMethod((...d)=>{const l=p(...d);if(!l)return;const{text:h,icon:a,...b}=l,R=e(At,{type:"button",...b,icon:a&&e(dt,{source:a}),children:h});this._setProps(Nt=>({children:[...Nt.children||[],R]}))})}},children:!(r!=null&&r.Actions)&&e(At,{size:"medium",type:"submit",icon:e(dt,{source:"Cart"}),disabled:!(t!=null&&t.inStock)||!Q,"aria-label":$,onClick:()=>G==null?void 0:G(P),children:$})}),shortDescription:v?void 0:e(A,{name:"ShortDescription",slot:r==null?void 0:r.ShortDescription,context:{..._},children:e("div",{dangerouslySetInnerHTML:{__html:(t==null?void 0:t.shortDescription)??""}})}),description:O?void 0:e(A,{name:"Description",slot:r==null?void 0:r.Description,context:{..._},children:e("div",{dangerouslySetInnerHTML:{__html:(t==null?void 0:t.description)??""}})}),images:((Z=t==null?void 0:t.images)==null?void 0:Z.map(({label:p,url:d})=>{var l,h;return e(bt,{title:p,alt:p,src:d,width:((l=i==null?void 0:i.imageParams)==null?void 0:l.width)??960,height:((h=i==null?void 0:i.imageParams)==null?void 0:h.height)??1191,params:(i==null?void 0:i.imageParams)??{width:960}},d)}))??[],specialPrice:(at=t==null?void 0:t.prices)!=null&&at.visible?e(A,{name:"SpecialPrice",slot:r==null?void 0:r.SpecialPrice,context:{..._},children:e(Pt,{...t.prices.final,locale:ut(U)})}):void 0,price:(ot=t==null?void 0:t.prices)!=null&&ot.visible&&t.prices.regular&&t.prices.final.amount!==(t==null?void 0:t.prices.regular.amount)?e(A,{name:"RegularPrice",slot:r==null?void 0:r.RegularPrice,context:{..._},children:e(Pt,{...t.prices.regular,locale:ut(U)})}):void 0,zoomType:it,closeButton:J,carouselConfig:{...i,thumbnails:i&&Object.keys(i).length?((_t=t==null?void 0:t.images)==null?void 0:_t.map(({label:p,url:d})=>{var l,h;return e(bt,{title:p,alt:p,src:d,width:((l=i==null?void 0:i.thumbnailParams)==null?void 0:l.width)??200,height:((h=i==null?void 0:i.thumbnailParams)==null?void 0:h.height)??248,params:(i==null?void 0:i.thumbnailParams)??{width:200}},d)}))??[]:[]},outOfStock:!(t!=null&&t.inStock),attributes:I?void 0:e(A,{name:"Attributes",slot:r==null?void 0:r.Attributes,context:{..._},children:D!=null&&D.length?V(vt,{children:[rt,e("ul",{children:D})]}):null}),galleryContent:(r==null?void 0:r.GalleryContent)&&e(A,{name:"GalleryContent",slot:r.GalleryContent,context:{..._}}),infoContent:(r==null?void 0:r.InfoContent)&&e(A,{name:"InfoContent",slot:r.InfoContent,context:{..._}}),productContent:(r==null?void 0:r.Content)&&e(A,{name:"Content",slot:r.Content,context:{..._}})})})};Mt.getInitialData=async function({sku:o,disableDropdownPreselection:N=!1,optionsConfig:S}){var O,I;const v=(I=(O=St.getConfig().models)==null?void 0:O.ProductDetails)==null?void 0:I.initialData;return v?Ut(v):ht(o,{preselectFirstOption:!N,anchors:S==null?void 0:S.anchorOptions})};export{Mt as ProductDetails,Mt as default};
