/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as g}from"@dropins/tools/preact-jsx-runtime.js";import{useState as o,useEffect as P}from"@dropins/tools/preact-compat.js";import{classes as y}from"@dropins/tools/lib.js";import{Incrementer as I}from"@dropins/tools/components.js";import{events as m}from"@dropins/tools/event-bus.js";import{n as q,j as b,c as N,o as D}from"../chunks/isProductConfigurationValid.js";import{g as h}from"../chunks/getFetchedProductData.js";import{useText as x}from"@dropins/tools/i18n.js";import"../fragments.js";import"@dropins/tools/fetch-graphql.js";const C=({initialData:u=null,onValue:n,children:Q,...s})=>{const c=x("PDP.Product.Incrementer.label").label,[l,f]=o(u),[i,p]=o(()=>{const r=q()||{};let t=1;const a=r.quantity;if(a){const e=parseInt(a,10);!isNaN(e)&&Number.isInteger(e)&&e>0&&(t=e)}return t});P(()=>{const r=m.on("pdp/data",f),t=m.on("pdp/values",({quantity:a})=>{p(a)},{eager:!0});return()=>{r==null||r.off(),t==null||t.off()}},[]);const d=r=>{const t=parseInt(r,10);b(e=>({...e,quantity:t}));const{persistURLParams:a}=N.getConfig()??{};a&&D({quantity:t}),n==null||n(t)};return l?g(I,{name:"quantity",defaultValue:String(i),value:String(i),min:1,"aria-label":c,onValue:d,...s,className:y(["pdp-quantity",s.className])},"quantity"):null};C.getInitialData=h;export{C as ProductQuantity,C as default};
